#                  breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
# scale_x_discrete(limits = c(paste(1:51),NA),
#                  breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE,space = "free")
ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
# scale_x_discrete(limits = c(paste(1:51),NA),
#                  breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '')
ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
# scale_x_discrete(limits = c(paste(1:51),NA),
#                  breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
## plot lat long first, then year
plist[[idx]]  <- ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
# scale_x_discrete(limits = c(paste(1:51),NA),
#                  breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
plist[[idx]]  <- ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 4)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
## plot lat long first, then year
plist[[idx]]  <- ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
plist[[idx]]  <- ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 4)
ntrue
ntrue <- read.csv("input_data/ntrue_a6.csv", na.strings = 'NA') %>% filter(scen != 'F0L1S_R3') %>% mutate(value = 1)
ntrue
ntrue <- read.csv("input_data/ntrue_a6.csv", na.strings = 'NA') %>% filter(scen != 'F0L1S_R3') %>% mutate(value = 1)
levels(cdf_gam$scen) <- levels(ntrue$scen) <- c("Scenario 2", "Scenario 4", NA,
"Scenario 3","Scenario 1",
"Scenario 5")
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
## plot lat long first, then year
plist[[idx]]  <- ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
plist[[idx]]  <- ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 4)
ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
## plot lat long first, then year
plist[[idx]]  <- ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
plist[[idx]]  <- ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
}
plist[[1]]
plist[[2]]
plist[[3]]
plist[[4]]
plist[[5]]
l = 3
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
subset(tmp, variable != 'Year')
tmp
scentemp
length(unique(cdf_gam$scen)
)
unique(cdf_gam$scen)
cdf_gam <- read.csv("GAM_output/cdf_2019-05-28.csv") %>% filter(scen != 'F0L1S_R3')
ntrue <- read.csv("input_data/ntrue_a6.csv", na.strings = 'NA') %>% filter(scen != 'F0L1S_R3') %>% mutate(value = 1)
levels(cdf_gam$scen) <- levels(ntrue$scen) <- c("Scenario 2", "Scenario 4", NA,
"Scenario 3","Scenario 1",
"Scenario 5")
levels(cdf_gam$scen)
unique(cdf_gam$scen)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
## plot lat long first, then year
plist[[idx]]  <- ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
# geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
#               xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
#           fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
plist[[idx]]  <- ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 4)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
## plot lat long first, then year
plist[[idx]]  <- ggplot(subset(tmp, variable != 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:51),NA),
breaks = c(paste(seq(0,51,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 2,drop=TRUE) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data = subset(ntrue, scen == scentemp & variable != 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
plist[[idx]]  <- ggplot(subset(tmp, variable == 'Year'), aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:101),NA),
breaks = c(paste(seq(0,101,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = '') +
geom_bar(data =  subset(ntrue, scen == scentemp & variable == 'Year'),
aes(x = factor(trueb), y = value), col = 'red', stat = 'identity', alpha = 0.5)
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 4)
grid.arrange(grobs = plist, ncol = 4) %>%
ggsave(plot = .,   file = paste0("./figures/GAM_hist_breaks.png"), width = 10, height = 12, units = 'in', dpi = 480)
## 188+16+96 /396 is 75% correct for YEAR when relaxed
cdf_gam %>% filter(scen == 'tempvar_R1R2') %>% group_by(YEAR) %>% dplyr::summarise(n = n())
cdf_gam %>% filter(scen == 'tempvar_R1R2' & YEAR == FALSE & gamYR %in% c(49,51)) %>% group_by(gamYR) %>% dplyr::summarise(n = n())
cdf_gam
cdf_gam %>% filter(scen == 'tempvar_R1R2' & YEAR == FALSE & gamYR %in% c(49,51))
cdf_gam %>% filter(scen == 'tempvar_R1R2' & YEAR == FALSE) %>% group_by(gamYR) %>% dplyr::summarise(n = n())
## summarise MISSED proportions ----
cdf_gam <- read.csv(paste0("GAM_output/cdf_2019-05-28.csv"))
cdf_gam %>% filter(scen == 'tempvar_R1R2' & YEAR == FALSE & gamYR %in% c(49,51)) %>% group_by(gamYR) %>% dplyr::summarise(n = n())
296/396
cdf_stars <- read.csv(paste0("STARS_output/STARS_cdf_2019-05-27.csv"))
cdfaccu_stars <- read.csv(paste0("STARS_output/STARS_cdf_accu_2019-05-27.csv"))
cdfprop_stars <- read.csv(paste0("STARS_output/STARS_cdf_prop_2019-05-27.csv"))
## percent accuracy by cat
cdfaccu_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% summarise(avg = mean(prop))
cdfprop_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% summarise(avg = mean(prop))
cdfprop_gam %>%  filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>%group_by(variable) %>% summarise(avg = mean(prop))
cdfaccu_gam <- read.csv(paste0("GAM_output/cdf_accu_2019-05-28.csv"))
cdfprop_gam <- read.csv(paste0("GAM_output/cdf_prop_2019-05-28.csv"))
cdfprop_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% summarise(avg = mean(prop))
cdfprop_gam %>%  filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>%group_by(variable) %>% summarise(avg = mean(prop))
cdfprop_stars
cdfprop_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% dplyr::summarise(avg = mean(prop))
cdfprop_gam %>%  filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>%group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_gam %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_gam
cdfprop_gam
