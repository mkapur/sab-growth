theme_black(base_size = 18) +
theme(panel.grid = element_blank())+
geom_vline(xintercept = ifelse(is.na(breaksdf[[t]]),-999,breaksdf[[t]]), lwd = 1.1, linetype = 'dashed', col = 'red') +
# scale_x_continuous(expand = c(0,0), limits = c(ifelse(t == 2, 30, min(temp$x)),max(temp$x))) +
scale_x_continuous(expand = c(0,0), limits = c(xlims[1,t],xlims[2,t])) +
scale_y_continuous(limits = c(ifelse(t == 3, -15, min(temp$fit)*3), ifelse(t == 3, 10, max(temp$fit)*3)))  +
geom_line(lwd = 1.1, col = 'white') +
geom_line(aes(y= fit-se), linetype = 'dashed', col = 'white') +
geom_line(aes(y= fit+se), linetype = 'dashed', col = 'white') +
geom_rug(sides = 'b') +
labs(x = Terms[t], y = "smoother", title = paste0(letters[idx],") ",'Smoother for ', temp0[[1]]$xlab))
plist[[idx]]
grid.arrange(grobs = plist, layout_matrix = lay)
grid.arrange(grobs = plist, layout_matrix = lay)  %>%
ggsave(plot = .,  file = paste0("./figures/BLACK_sab_smooth_map_",AA,SS,".png"), width = 12, height = 15, units = 'in', dpi = 480)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'white', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions with Age 30 Fish") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 6, col = 'black',fill = 'white',show.legend   =FALSE)
## black map w breaks (not currents)
usa <- map_data("world")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'white', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions with Age 30 Fish") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 6, col = 'black',fill = 'white',show.legend   =FALSE)
?coord_quickmap
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap(fill = 'grey99') +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions with Age 30 Fish") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 6, col = 'black',fill = 'white',show.legend   =FALSE)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions with Age 30 Fish") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 6, col = 'black',fill = 'white',show.legend   =FALSE)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
# geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
# scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions with Age 30 Fish") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 6, col = 'black',fill = 'white',show.legend   =FALSE)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
# geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
# scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 6, col = 'black',fill = 'white',show.legend   =FALSE)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
# geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
# scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 12, col = 'black',fill = 'white',show.legend   =FALSE)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1, ymin = 30, ymax = 49.9)) +
# geom_point(data = dat, aes(x = Longitude_dd, y = Latitude_dd, size = Length_cm, fill = Length_cm), shape = 21, alpha = 0.7) +
# scale_fill_viridis_c(guide = "legend") +
labs(fill = paste0("Length (cm)"),
size = paste0("Length (cm)"),
title = "GAM- and Ecosystem-based Regions") +
geom_label(aes(x = c(-155,-138,-120,-120,-120),
y = c(65,65,65,40,32),
label = c(paste('Region ',5:1)) ),size = 8, col = 'black',fill = 'white',show.legend   =FALSE)
ggsave(plot = last_plot(),  file = paste0("./figures/BLACK_sab_zones.png"), width = 8, height = 6, units = 'in', dpi = 480)
ggsave(plot = last_plot(),  file = paste0("./figures/BLACK_sab_zones.png"), width = 18, height = 12, units = 'in', dpi = 480)
# install.packages('oceanmap')
library(oceanmap)
# https://rstudio-pubs-static.s3.amazonaws.com/301644_61297506548c4b3cb9e7cc8cbc8578ce.html
# https://www.arcgis.com/home/item.html?id=24bfd85e97b042948e6ed4928dc45a8b
devtools::install_github("yonghah/esri2sf")
# https://rstudio-pubs-static.s3.amazonaws.com/301644_61297506548c4b3cb9e7cc8cbc8578ce.html
# https://www.arcgis.com/home/item.html?id=24bfd85e97b042948e6ed4928dc45a8b
# devtools::install_github("yonghah/esri2sf")
library("esri2sf")
# https://rstudio-pubs-static.s3.amazonaws.com/301644_61297506548c4b3cb9e7cc8cbc8578ce.html
# https://www.arcgis.com/home/item.html?id=24bfd85e97b042948e6ed4928dc45a8b
# devtools::install_github("yonghah/esri2sf")
library(esri2sf)
devtools::install_github("yonghah/esri2sf")
# https://rstudio-pubs-static.s3.amazonaws.com/301644_61297506548c4b3cb9e7cc8cbc8578ce.html
# https://www.arcgis.com/home/item.html?id=24bfd85e97b042948e6ed4928dc45a8b
# devtools::install_github("yonghah/esri2sf")
library(esri2sf)
url <- "http://services1.arcgis.com/VAI453sU9tG9rSmh/arcgis/rest/services/WorldGeo_Physical_Climate_features/FeatureServer"
df <- esri2sf(url)
plot(df)
require(rgdal)
shape <- readOGR(dsn = "C:/Users/Maia Kapur/Dropbox/UW/sab-growth/raw_data/Major_Ocean_Currents_arrowPolys_30m_8",
layer = 'Major_Ocean_Currents_arrowPolys_30m_8')
shape <- readOGR(dsn = "C:/Users/MKapur/Dropbox/UW/sab-growth/raw_data/Major_Ocean_Currents_arrowPolys_30m_8",
layer = 'Major_Ocean_Currents_arrowPolys_30m_8')
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'black', col.land = 'grey44')
?plotmap
# figure ( width =9.75, height =5.28)
plotmap( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'black', col.land = 'grey44')
# figure ( width =9.75, height =5.28)
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'black', col.land = 'grey44')
# install.packages('oceanmap')
library(oceanmap)
install.packages('oceanmap')
# install.packages('oceanmap')
library(oceanmap)
# figure ( width =9.75, height =5.28)
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'black', col.land = 'grey44')
# figure ( width =9.75, height =5.28)
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44', )
# figure ( width =9.75, height =5.28)
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44' )
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44' )
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44' )
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
?legend
legend(x = -175, fill = NULL, y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
legend(x = -175,  bg = 'black', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
legend(x = -175,  bg = 'black', tex.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
dev.off()
plotmap(lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44' )
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), col = 'white', labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', tex.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
legend(x = -175,  bg = 'black', tex.col = 1, y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'grey90', col.land = 'white')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'black', col.land = 'grey44')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex = 17)
dev.off()
graphics.off()
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex = 17)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab =  = 17)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 17)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 6)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 2)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1)
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1, col = 'white')
?plotmap
## black ----
png("C:/Users/Maia Kapur/Dropbox/UW/sab-growth/figures/BLACK_Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1, col = 'white')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
## black ----
png("./figures/BLACK_Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1, col = 'white')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
dev.off()
graphics.off()
## black ----
png("./figures/BLACK_Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1, col = 'white')
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
dev.off()
## black ----
png("./figures/BLACK_Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1)
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
dev.off()
?segments
dev.off()
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1)
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed', lwd = 2)
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed', lwd = 2)
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed', lwd = 2)
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed', lwd = 2)
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1)
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed', lwd = 2)
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed', lwd = 2)
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed', lwd = 2)
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed', lwd = 2)
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
png("./figures/BLACK_Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'black', col.land = 'grey44',
cex.lab  = 2, cex.ticks = 1)
# grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed', lwd = 3)
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed', lwd = 3)
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed', lwd = 3)
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed', lwd = 3)
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'black', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), size = 12, col = 'white',labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175,  bg = 'black', text.col = 'white', y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,6)))
dev.off()
QCHI
qchisq(0.125,1)
qchisq(0.75,1)
