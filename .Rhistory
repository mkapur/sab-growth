require(TMB); require(dplyr); require(ggplot2); require(reshape)
options(scipen=999)
rm(list = ls())
## load objects made in dataprep
setwd("C:/Users/mkapur/Dropbox/UW/sab-growth")
load( paste0(getwd(),"/data/all_data.rda")) ## all_data
load( paste0(getwd(),"/data/DES.rda")) ## all_data
dim(DES)
dim(all_data)
compile("sptlvb.cpp")
dyn.load(dynlib("sptlvb"))
s = 3
nStrata <- length(unique(DES[,s]))
data <-
list(
Length_cm = all_data[,"Length_cm"],
Age = all_data[,"Age"],
DES = DES[,s],
nStrata = nStrata
)
parameters <-
list(
dummy = 0,
log_Linf = rep(log(70), nStrata),
log_k = rep(0, nStrata),
t0 = rep(0, nStrata),
sigma0 = 0.1,
sigma1 = 1
)
# Now estimate everything
map <- NULL
model <- MakeADFun(data, parameters,  DLL="sptlvb",silent=T,map=map)
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
class(DES)
vector(DES[,s])
as.vector(DES[,s])
data <-
list(
Length_cm = all_data[,"Length_cm"],
Age = all_data[,"Age"],
DES = as.vector(DES[,s]),
nStrata = nStrata
)
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
compile("sptlvb.cpp")
class(all_data[,"Length_cm"])
