theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity')
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 3)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity' alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 3)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), fill = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 3)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 3)
## GAM Histogram of detected breaks----
cdf_gam <- read.csv("GAM_output/cdf_2019-05-06.csv") %>% filter(scen != 'F0L1S_R3')
ntrue <- read.csv("input_data/ntrue_a6.csv") %>% filter(scen != 'F0L1S_R3') %>% mutate(value = 1)
levels(cdf_gam$scen) <- levels(ntrue$scen) <- c("Scenario 2 Break at 25 deg.", "Scenario 4 Break at 49 deg.", NA,
"Scenario 3 Overlap 20-25 deg.","Scenario 1 No Breaks",
"Scenario 5 Temporal Break Year 50")
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 3)
## GAM Histogram of detected breaks----
cdf_gam <- read.csv("GAM_output/cdf_2019-05-06.csv") %>% filter(scen != 'F0L1S_R3')
ntrue <- read.csv("input_data/ntrue_a6.csv") %>% filter(scen != 'F0L1S_R3') %>% mutate(value = 1)
levels(cdf_gam$scen) <- levels(ntrue$scen) <- c("Scenario 2 Break at 25 deg.", "Scenario 4 Break at 49 deg.", NA,
"Scenario 3 Overlap 20-25 deg.","Scenario 1 No Breaks",
"Scenario 5 Temporal Break Year 50")
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = c(0.9,0.1),
axis.text = element_text(size = 6),
axis.title = element_text(size = 6),
legend.text = element_text(size = 6),
strip.text = element_text(size= 6))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 3)
grid.arrange(grobs = plist, ncol = 3) %>%
ggsave(plot = .,   file = paste0("./figures/GAM_hist_breaks.png"), width = 12, height = 6, units = 'in', dpi = 480)
grid.arrange(grobs = plist, ncol = 2) %>%
ggsave(plot = .,   file = paste0("./figures/GAM_hist_breaks.png"), width = 10, height = 12, units = 'in', dpi = 480)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 8))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 2) %>%
ggsave(plot = .,   file = paste0("./figures/GAM_hist_breaks.png"), width = 10, height = 12, units = 'in', dpi = 480)
cdf_gam <- read.csv("GAM_output/cdf_2019-05-06.csv") %>% filter(scen != 'F0L1S_R3')
ntrue <- read.csv("input_data/ntrue_a6.csv") %>% filter(scen != 'F0L1S_R3') %>% mutate(value = 1)
levels(cdf_gam$scen) <- levels(ntrue$scen) <- c("Scenario 2", "Scenario 4", NA,
"Scenario 3","Scenario 1",
"Scenario 5")
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l != 5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 2) %>%
ggsave(plot = .,   file = paste0("./figures/GAM_hist_breaks.png"), width = 10, height = 12, units = 'in', dpi = 480)
c(paste(1:ifelse(l != 5 & variable == 'Year', 55, 110)),NA)
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
# xmax <-
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:ifelse(l != 5 & variable == 'Year', 55, 110)),NA),breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:ifelse(variable == 'Year', 55, 110)),NA),
breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
# scale_x_discrete(limits = c(paste(1:ifelse(variable == 'Year', 55, 110)),NA),
#                  breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3, scales = 'free_x') +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
# scale_x_discrete(limits = c(paste(1:ifelse(variable == 'Year', 55, 110)),NA),
#                  breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3, scales = 'free_x')
tmp
ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:ifelse(variable == 'Year', 55, 110)),NA),
breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
plist <- list(); idx = 1
for(l in 1:length(unique(cdf_gam$scen))){
scentemp <- unique(cdf_gam$scen)[l]
# scen <- paste0(ldfprop$scen[ldfprop$scentemp == scentemp]) ## filenames
cat(l,idx,"\n")
tmp0 <- cdf_gam %>%  filter(scen == scentemp) %>% select(scen, gamLAT, gamLON, gamYR) %>% melt(id = c('scen'))
levels(tmp0$variable) <- c('Latitude','Longitude','Year')
tmp0$value <- factor(tmp0$value, levels=c(paste(1:100),NA))
tmp <- tmp0 %>%
group_by(variable, value) %>%
dplyr::summarise(n = n()) %>%
mutate(freq = n / sum(n), scen = scentemp)
xmax <- ifelse(l==5, 55, 110)
plist[[idx]]  <- ggplot(tmp, aes(x = value, y = freq)) +
geom_bar(stat = 'identity') +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text = element_text(size = 6),
axis.title = element_text(size = 8),
legend.text = element_text(size = 6),
strip.text = element_text(size= 9))+
scale_y_continuous(limits = c(0,1)) +
scale_x_discrete(limits = c(paste(1:xmax),NA),
breaks = c(paste(seq(0,xmax,10)),NA)) +
geom_rect(aes(xmin = ifelse(variable != 'Year', 20,-10),
xmax = ifelse(variable != 'Year', 25,-10), ymin = 0, ymax = Inf),
fill=ifelse(l == 3,"red",NA), alpha = 1E-2) +
facet_wrap(~scen+variable,ncol = 3) +
labs( y = 'frequency', x = 'detected break location', title = 'GAM-detected Breaks') +
geom_bar(data = subset(ntrue, scen == scentemp),
aes(x = trueb, y = value), col = 'red', stat = 'identity', alpha = 1E-2)
# geom_vline(data = subset(ntrue, scen == scentemp),
#              aes(xintercept = trueb), col = 'red', linetype = 'dashed')
idx <- idx +1
}
grid.arrange(grobs = plist, ncol = 2) %>%
ggsave(plot = .,   file = paste0("./figures/GAM_hist_breaks.png"), width = 10, height = 12, units = 'in', dpi = 480)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_brewer(palette =  'Accent')+
geom_point(alpha = 0.5, aes(y = Length_cm)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "longdash", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
?linetype
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_brewer(palette =  'Accent')+
geom_point(alpha = 0.5, aes(y = Length_cm)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
phase
ggsave(plot = last_plot(),
file = paste0("./figures/sab_fits_",Sys.Date(),"_",phase,".png"),
width = 10, height = 12, units = 'in', dpi = 520)
head(dat)
