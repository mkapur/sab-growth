scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
size = Residual_scaled, fill = Residual),
shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "none") +
scale_size_identity(guide = "legend") +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
summary(ypreds0$Residual_scaled)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
size = Residual_scaled, fill = Residual),
shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "none") +
scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
size = Residual_scaled, fill = Residual),
shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "legend") +
scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7) +
scale_fill_viridis_c(guide = "legend") +
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend") +
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
# scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
scale_fill_brewer(palette = 'Reds')
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
# scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
scale_fill_manual(palette = 'Reds')
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
# scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
scale_fill_gradientn(palette = 'Reds')
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
# scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
scale_fill_gradientn(colors = brewer.pal('Reds'))
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
# scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
scale_fill_gradientn(colors = brewer.pal(20,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
# scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
scale_fill_gradientn(colors = brewer.pal(9,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
# scale_fill_gradientn(colors = brewer.pal(9,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length (cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.1,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
# scale_fill_gradientn(colors = brewer.pal(9,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length Residual(cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.2,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
# scale_fill_gradientn(colors = brewer.pal(9,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length Residual(cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model (female sablefish)")
ggsave(plot = last_plot(),
file = paste0("./figures/BLACK_resids.png"),
width = 10, height = 10, units = 'in', dpi = 480)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 20) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.2,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
# geom_hline(yintercept = c(36,50),lwd = 1.1, linetype = 'dashed', col = 'red') +
# geom_vline(xintercept =  -130, lwd = 1.1, linetype = 'dashed', col = 'red') +
## ecosystem break
# geom_vline(xintercept =  -145, lwd = 1.1, linetype = 'dashed', col = 'blue') +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
# scale_fill_gradientn(colors = brewer.pal(9,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length Residual(cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model",
subtitle = "female sablefish")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 18) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.2,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_rect(fill = 'black', aes(xmin = -180, xmax = -130.1,
ymin = 30, ymax = 49.9)) +
geom_point(data = sample_n(subset(ypreds0, Sex == 'F'),5000),
aes(x = Longitude_dd, y = Latitude_dd,
fill = Residual),
shape = 21, alpha = 0.7, size = 10) +
scale_fill_viridis_c(guide = "legend", limits = c(-20,20)) +
# scale_fill_gradientn(colors = brewer.pal(9,'Reds'))+
# scale_size_identity(guide = "legend", limits = c(-10,10)) +
# scale_size_manual(guide = 'none')+
labs(fill = paste0("Length Residual(cm)"),
title = "Residuals for Coastwide Von Bertalanffy Model",
subtitle = "female sablefish")
ggsave(plot = last_plot(),
file = paste0("./figures/BLACK_resids.png"),
width = 10, height = 10, units = 'in', dpi = 480)
require(ggplot2)
require(kaputils)
require(dplyr)
source("C:/Users/mkapur/Dropbox/kaputils/R/theme_black.R")
## black neatplot from sab with faceted curves
ypreds <- read.csv(paste0("C:/Users/mkapur/Dropbox/UW/sab-growth/GAM_output/SAB_predicts_2019-10-04_phase2.csv"))
## black neatplot from sab with faceted curves
ypreds <- read.csv(paste0("C:/Users/maia kapur/Dropbox/UW/sab-growth/GAM_output/SAB_predicts_2019-10-04_phase2.csv"))
ypreds$gamREG <- paste0('Region ',ypreds$gamREG)
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-Present','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
fd_summary_gamREG <- ypreds %>%
filter(Age < 31) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
theme_black(base_size = 20) +
theme(panel.grid = element_blank(),
legend.position = 'right') +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_brewer(palette =  'Accent')+
geom_point( aes(y = meanL)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "GAM-Detected Region") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~Sex +Period, ncol = 4)
#
ggsave(plot  = last_plot(),
file = "C:/Users/mkapur/Dropbox/UW/sab-growth/figures/ICES_black_figs/VBGF_meanL_periodXregion_black.png",
height = 8, width = 16, unit = 'in', dpi = 520)
#
ggsave(plot  = last_plot(),
file = "C:/Users/maia kapur/Dropbox/UW/sab-growth/figures/ICES_black_figs/VBGF_meanL_periodXregion_black.png",
height = 8, width = 16, unit = 'in', dpi = 520)
require(ggplot2)
require(kaputils)
require(dplyr)
source("C:/Users/mkapur/Dropbox/kaputils/R/theme_black.R")
usa <- map_data("world")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap()
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "Â°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "Â°N"))  +
theme_black(base_size = 18) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.2,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12))
usa <- map_data("world")
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group), fill = 'grey66') +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,10), labels = paste(seq(-180,-120,10), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_black(base_size = 18) +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = c(0.2,0.2),
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12))
ggsave(plot = last_plot(),
file = paste0("./figures/ICES_black_figs/map_black.png"),
width = 10, height = 10, units = 'in', dpi = 520)
