str(shape)
plot(shape,  ylim = lat, col = c('blue','grey22','red'), add = T)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'skyblue', col.land = 'grey88')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
plot(shape,  ylim = lat, col = c('goldenrod','seagreen4','grey22'), add = T)
plot(shape,  ylim = lat, col = c('goldenrod','goldenrod','seagreen4','grey22'), add = T)
plot(shape,  ylim = lat, col = c('goldenrod','goldenrod','seagreen4','seagreen4','grey22'), add = T)
plot(shape,  ylim = lat, col = c('goldenrod','red','blue','seagreen4','grey22'), add = T)
brewer.pal(5,'Spectral')
plot(shape,  ylim = lat, col = brewer.pal(5,'Spectral'), add = T)
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#FFFFBF", "#ABDDA4" ,"grey22"), add = T)
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#FFFFBF", "#ABDDA4" ,"FFFFBF"), add = T)
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#FFFFBF", "#ABDDA4" ,"#FFFFBF"), add = T)
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#FFFFBF", "#ABDDA4" ,"#FDAE61"), add = T)
D7191C
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#FFFFBF", "#ABDDA4" ,"#D7191C"), add = T)
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#FFFFBF", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "#D7191C", "#FDAE61", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "dodgerblue4", "#FDAE61", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "goldenrod", "#FDAE61", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "gold", "#FDAE61", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "gold", "blue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "gold", "grey22", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey99', col.land = 'grey88')
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = NA)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), add = T)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), bg = 'white', add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
?rect
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', add = T)
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (20, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (28, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 30, xright = -144, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border =c(rep('white',4),NA), add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -131, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border =c(rep('white',4),NA), add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -13, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border =c(rep('white',4),NA), add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -130, ytop = 49, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border =c(rep('white',4),NA), add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -130, ytop = 50, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border =c(rep('white',4),NA), add = T)
lon <- c (-180, -110)
lat <- c (25, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,NA), border =c(rep('white',4),NA), add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border =c(rep('white',4),NA), add = T)
lat <- c (26, 74)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border =c(rep('white',4),NA), add = T)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 25, xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = -180, ybottom = 26, xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
?annotate
?text
text(x = c(-160,-140,-120,-120,-120), y = c(65,65,55,45,30), labels = rep("mk",5))
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-115,-115,-115), y = c(65,65,55,45,30), labels = rep("mk",5))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
text(x = c(-155,-135,-120,-120,-120), y = c(65,65,55,45,35), labels = rep("mk",5))
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-117), y = c(65,65,55,45,35), labels = rep("mk",5))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
text(x = c(-155,-135,-117,-117,-117), y = c(65,65,55,45,35), labels = paste('Region',5:1))
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
abline(h = c(36,50), add = T, col = 'red', lty = 'dashed')
abline(v = c(-145,-130), add = T, col =c('blue', 'red'), lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-117), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
segments(-180, 50, x1 = -115, y1 = 50)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey88', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-117), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey99', col.land = 'white')
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-117), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
legend('bottomleft', legend = c('Alaskan Current','Pacific Current', 'S. California Bight'))
?legend
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'))
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
cols = c('dodgerblue','#ABDDA4','gold'))
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
colors = c('dodgerblue','#ABDDA4','gold'))
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
col = c('dodgerblue','#ABDDA4','gold'))
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
col = c('dodgerblue','#ABDDA4','gold'), lty = 1)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
col = c('dodgerblue','#ABDDA4','gold'), lty = 1, cex = 2)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
col = c('dodgerblue','#ABDDA4','gold'), lty = 1, lwd = 2)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight'),
col = c('dodgerblue','#ABDDA4','gold'), lty = 1, lwd = 5)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM Detected Regions'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = 5)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM Detected Regions'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM Detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-117), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
png("C:/Users/Maia Kapur/Dropbox/UW/sab-growth/figures/Figure5.png",height = 10, width = 8, unit = 'in', dpi = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
dev.off()
png("C:/Users/Maia Kapur/Dropbox/UW/sab-growth/figures/Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','Pacific Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
dev.off()
cdf_gam %>%
filter(scen == 'F0L1S_49' & (LON == FALSE | LAT == FALSE)) %>%
group_by(gamLAT,gamLON) %>% dplyr::summarise(n=n())
2+82+72+12+7
cdf_gam %>%
filter(scen == 'F0L1S_49') %>% nrow(.
)
175/223
## "no discernable pattern in spurious breaks"
# cdf %>% filter(scen %in% c('NoBreaks','tempvar_R1R2') & (LAT == FALSE  | LON == FALSE)) %>% group_by(scen, gamLAT,gamLON) %>% dplyr::summarise(n = n())
# ## what proportion of wrong ones are only one off?
# cdf %>% filter(!(scen %in% c('NoBreaks','tempvar_R1R2')) & (LAT == FALSE  | LON == FALSE)) %>%
#   group_by(scen) %>% dplyr::summarise(n = n())
#
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
group_by(scen) %>% dplyr::summarise(n = n(), inbounds = sum(gamLAT %in% c(24,26)   |gamLON %in% c(24,26)  )) %>% mutate(inbounds/n)
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
group_by(scen) %>% dplyr::summarise(n = n())
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
unique(gamLAT)
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
unique(.$gamLAT)
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
View()
## "no discernable pattern in spurious breaks"
# cdf %>% filter(scen %in% c('NoBreaks','tempvar_R1R2') & (LAT == FALSE  | LON == FALSE)) %>% group_by(scen, gamLAT,gamLON) %>% dplyr::summarise(n = n())
# ## what proportion of wrong ones are only one off?
# cdf %>% filter(!(scen %in% c('NoBreaks','tempvar_R1R2')) & (LAT == FALSE  | LON == FALSE)) %>%
#   group_by(scen) %>% dplyr::summarise(n = n())
#
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
group_by(scen) %>% dplyr::summarise(n = n(),
inbounds = sum(gamLAT %in% c(24,26) |gamLON %in% c(24,26)  )) %>% mutate(inbounds/n)
# cdf %>% filter(YEAR == FALSE) %>% group_by(scen, gamYR) %>% dplyr::summarise(n = n())
# cdf %>% filter(scen == 'F0LMW'& LAT == FALSE) %>% group_by(gamLAT) %>% dplyr::summarise(n = n())
# cdf %>% group_by(YEAR) %>% dplyr::summarise(n = n())
#
#
# ## 184+16+96 /396 is 75% correct for YEAR when relaxed
cdf_gam %>% filter(scen == 'tempvar_R1R2') %>% group_by(YEAR) %>% dplyr::summarise(n = n())
cdf_gam %>% filter(scen == 'tempvar_R1R2' & YEAR == FALSE & gamYR %in% c(49,51)) %>% group_by(gamYR) %>% dplyr::summarise(n = n())
16+156
172/280
116+16+156
280+116
288/396
cdfaccu_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_gam %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfprop_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% dplyr::summarise(avg = mean(prop))
cdfprop_gam %>%  filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>%group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
## GAM/STARS summarise MISSED proportions ----
# cdf_gam <- read.csv(paste0("GAM_output/cdf_2019-06-10.csv"))
# cdfaccu_gam <- read.csv(paste0("GAM_output/cdf_accu_2019-05-28.csv"))
# cdfprop_gam <- read.csv(paste0("GAM_output/cdf_prop_2019-05-28.csv"))
#
# cdf_stars <- read.csv(paste0("STARS_output/STARS_cdf_",Sys.Date(),".csv"))
# cdfaccu_stars <- read.csv(paste0("STARS_output/STARS_cdf_accu_",Sys.Date(),".csv"))
cdfprop_stars <- read.csv(paste0("STARS_output/STARS_cdf_prop_2019-06-10.csv"))
cdfaccu_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_gam %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfprop_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% dplyr::summarise(avg = mean(prop))
cdfprop_gam %>%  filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>%group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
## GAM/STARS summarise MISSED proportions ----
# cdf_gam <- read.csv(paste0("GAM_output/cdf_2019-06-10.csv"))
# cdfaccu_gam <- read.csv(paste0("GAM_output/cdf_accu_2019-05-28.csv"))
# cdfprop_gam <- read.csv(paste0("GAM_output/cdf_prop_2019-05-28.csv"))
#
# cdf_stars <- read.csv(paste0("STARS_output/STARS_cdf_",Sys.Date(),".csv"))
cdfaccu_stars <- read.csv(paste0("STARS_output/STARS_cdf_accu_2019-06-10.csv"))
# ## percent accuracy by cat
cdfaccu_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_gam %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfprop_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>% dplyr::summarise(avg = mean(prop))
cdfprop_gam %>%  filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>%group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
## SAB STUFF ## ----
#
# cdf_gam %>% filter(scen == 'tempvar_R1R2' & YEAR == FALSE ) %>% group_by(gamYR) %>% dplyr::summarise(n = n())
#
#
#
# ## percent accuracy by cat
cdfaccu_stars %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
cdfaccu_gam %>% filter(scen != 'F0L1S_R3' & scen != 'F0L1S_49') %>% group_by(variable) %>%  dplyr::summarise(avg = mean(prop))
## "no discernable pattern in spurious breaks"
# cdf %>% filter(scen %in% c('NoBreaks','tempvar_R1R2') & (LAT == FALSE  | LON == FALSE)) %>% group_by(scen, gamLAT,gamLON) %>% dplyr::summarise(n = n())
# ## what proportion of wrong ones are only one off?
# cdf %>% filter(!(scen %in% c('NoBreaks','tempvar_R1R2')) & (LAT == FALSE  | LON == FALSE)) %>%
#   group_by(scen) %>% dplyr::summarise(n = n())
# #
cdf_gam %>% filter(scen %in% c('F0L1S_25','F0L1S_R3') & (LAT == FALSE  | LON == FALSE)) %>%
group_by(scen) %>% dplyr::summarise(n = n(),
inbounds = sum(gamLAT %in% c(24,26) |gamLON %in% c(24,26)  )) %>% mutate(inbounds/n)
png("C:/Users/Maia Kapur/Dropbox/UW/sab-growth/figures/Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"#ABDDA4"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
dev.off()
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific and California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific',' California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,3),2,2), lwd = c(rep(5,3),1,1))
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific Current',' California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
png("C:/Users/Maia Kapur/Dropbox/UW/sab-growth/figures/Figure5.png",height = 10, width = 8, unit = 'in', res = 520)
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = F, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific Current',' California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
dev.off()
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "#ABDDA4" ,"grey22","grey22"), border = 'white', add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "grey22" ,"grey22",), border = 'white', add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", "#ABDDA4", "grey22" ,"grey22"), border = 'white', add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", 'pink',"#ABDDA4", "ABDDA4" ,"grey22"), border = 'white', add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue", 'pink',"#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'grey90', col.land = 'white')
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific Current',' California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
lon <- c (-180, -110)
lat <- c (26, 74)
# figure ( width =9.75, height =5.28)
plotmap ( lon=lon ,  lat=lat , main ="Northeast Pacific", grid = T, col.bg = 'grey90', col.land = 'white')
grid()
segments(lon[1], 50, x1 = lon[2], y1 = 50, col = 'red', lty = 'dashed')
segments(lon[1], 36, x1 = lon[2], y1 = 36, col = 'red', lty = 'dashed')
segments(-130, lat[1], x1 = -130, y1 = lat[2], col = 'red', lty = 'dashed')
segments(-145, lat[1], x1 = -145, y1 = lat[2], col = 'blue', lty = 'dashed')
rect(xleft = lon[1], ybottom = lat[1], xright = -130, ytop = 49.5, col = 'grey88', border = NA, add = T)
text(x = c(-155,-135,-117,-117,-115), y = c(65,65,55,45,35), labels = paste('Region',5:1))
plot(shape,  ylim = lat, col = c( "gold", "dodgerblue","#ABDDA4", "#ABDDA4" ,"grey22"), border = 'white', add = T)
legend(x = -175, y = 40, legend = c('Alaskan Current','N. Pacific Current','California Current', 'S. California Bight', 'GAM-detected Regions', 'Ecosystem break'),
col = c('dodgerblue','#ABDDA4','grey22','gold','red','blue'), lty = c(rep(1,4),2,2), lwd = c(rep(5,4),1,1))
