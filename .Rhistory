# lower = lowbnd,
# upper = uppbnd
)
best <- model$env$last.par.best
print(best)
rep <- sdreport(model)
print(summary(rep))
print(exp(summary(rep)))
?scipen
options(scipen=999)
print(exp(summary(rep)))
print(round(exp(summary(rep)), digits = 2)
)
print(round(exp(summary(rep)), digits = 4))
compile("sptlvb.cpp")
dyn.load(dynlib("sptlvb"))
# Now estimate everything
map <- NULL
model <- MakeADFun(data, parameters,  DLL="sptlvb",silent=T,map=map)
model$report()
# Bounds on the parameters MAKE
fit <- nlminb(
model$par,
model$fn,
model$gr,
control = list(
rel.tol = 1e-12,
eval.max = 100000,
iter.max = 1000
)
# ,
# lower = lowbnd,
# upper = uppbnd
)
best <- model$env$last.par.best
rep <- sdreport(model)
print(best)
print(round(exp(summary(rep)), digits = 4))
compile("sptlvb.cpp")
dyn.load(dynlib("sptlvb"))
# Now estimate everything
map <- NULL
model <- MakeADFun(data, parameters,  DLL="sptlvb",silent=T,map=map)
model$report()
# Bounds on the parameters MAKE SURE THESE MATCH THE ORDER AND SIZE OF EACH PARAM
# lowbnd = c( -10, -7, rep(0.1,m),rep(-7,m), rep(-Inf,m))
# uppbnd = c( 10, 4, rep(1000,m),rep(4,m), rep(Inf,m))
fit <- nlminb(
model$par,
model$fn,
model$gr,
control = list(
rel.tol = 1e-12,
eval.max = 100000,
iter.max = 1000
)
# ,
# lower = lowbnd,
# upper = uppbnd
)
best <- model$env$last.par.best
print(best)
rep <- sdreport(model)
print(round(exp(summary(rep)), digits = 4))
compile("sptlvb.cpp")
dyn.load(dynlib("sptlvb"))
# Now estimate everything
map <- NULL
model <- MakeADFun(data, parameters,  DLL="sptlvb",silent=T,map=map)
model$report()
# Bounds on the parameters MAKE SURE THESE MATCH THE ORDER AND SIZE OF EACH PARAM
# lowbnd = c( -10, -7, rep(0.1,m),rep(-7,m), rep(-Inf,m))
# uppbnd = c( 10, 4, rep(1000,m),rep(4,m), rep(Inf,m))
fit <- nlminb(
model$par,
model$fn,
model$gr,
control = list(
rel.tol = 1e-12,
eval.max = 100000,
iter.max = 1000
)
# ,
# lower = lowbnd,
# upper = uppbnd
)
best <- model$env$last.par.best
print(best)
rep <- sdreport(model)
print(round(exp(summary(rep)), digits = 4))
print(round(exp(summary(rep)), digits = 4))
print(best)
print(exp(best))
print(rep)
print(exp(rep))
compile("sptlvb.cpp")
dyn.load(dynlib("sptlvb"))
# Now estimate everything
map <- NULL
model <- MakeADFun(data, parameters,  DLL="sptlvb",silent=T,map=map)
model$report()
compile("sptlvb.cpp")
dyn.load(dynlib("sptlvb"))
# Now estimate everything
map <- NULL
model <- MakeADFun(data, parameters,  DLL="sptlvb",silent=T,map=map)
model$report()
model$report()$ypreds
head(len)
head(agemat)
dat0 <- model$report()$ypreds %>% data.frame()
names(dat0) <- unique(len$st_f)
agedf <- agemat %>% data.frame()
names(agedf) <- unique(len$st_f)
lendf <- lenmat %>% data.frame()
names(lendf) <- unique(len$st_f)
head(lendf)
reshape(lendf)
melt(lendf)
model$report()$ypreds %>% data.frame() %>% melt() %>% rename(c('value' = 'Predicted'))
## plotting
dat0 <- model$report()$ypreds %>% data.frame()
names(dat0) <- paste0(unique(len$st_f))
dat0 %>% melt() %>% rename(c('value' = 'Predicted'))
bind_cols(dat0,agedf,lendf)
bind_cols(dat0,agedf,lendf) %>% head()
dat0 <- model$report()$ypreds %>% data.frame()
names(dat0) <- paste0(unique(len$st_f))
dat0 <- dat0 %>% melt() %>% rename(c('value' = 'Predicted'))
agedf <- agemat %>% data.frame() %>% melt() %>% rename(c('value' = 'Age'))
lendf <- lenmat %>% data.frame() %>% melt() %>% rename(c('value' = 'Length'))
bind_cols(dat0,agedf,lendf) %>% head()
mdf <-bind_cols(dat0,agedf,lendf) %>% select(-variable1, -variable2)
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
geom_point(alpha = 0.2) +
facet_wrap(~ variable)
require(ggplot2)
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
geom_point(alpha = 0.2) +
facet_wrap(~ variable)
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
geom_point(alpha = 0.2) +
geom_point(aes(y = Predicted), color = alpha('blue',0.2))
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
geom_point(alpha = 0.2) +
geom_point(aes(y = Predicted), color = alpha('blue',0.2)) +
facet_wrap(~ variable)
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue')+
facet_wrap(~ variable)
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue')+
facet_wrap(~ variable)
print(exp(rep))
print(exp(best))
## change order for order
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue')+
facet_wrap(~ variable) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)')
ggsave(file = paste0(getwd(),"/plots/uniform_fits.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_grey()+
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
require(dplyr); require(reshape); require(RColorBrewer)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_brewer(Palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_brewer(alette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_brewer(palette = 'Accent') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f)
ggsave(file = paste0(getwd(),"/plots/la_strata.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggsave(file = paste0(getwd(),"/plots/la_strata.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue')+
facet_wrap(~ variable) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)')
ggsave(file = paste0(getwd(),"/plots/uniform_fits.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggsave(file = paste0(getwd(),"/plots/raw_data.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
mdf$st_f = factor(mdf$variable, levels=c('deep_n','mid_n','shallow_n','deep_s', "mid_s","shallow_s"))
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue')+
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)')
ggsave(file = paste0(getwd(),"/plots/uniform_fits.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
head(dat0)
dat0 <- model$report()$ypreds %>% data.frame()
names(dat0) <- paste0(unique(len$st_f))
dat0 <- dat0 %>% melt() #%>% rename(c('value' = 'Predicted', 'variable' = 'st'))
dat0$st_f = factor(dat0$variable, levels=c('deep_n','mid_n','shallow_n','deep_s', "mid_s","shallow_s"))
head(dat0)
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(data = dat0, aes(y = value), color = 'blue')+
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = )
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = dat0, aes(y = value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = dat0, aes(x = len$Age, y = value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
head(agedf)
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = dat0, aes(x = agedf$Age, y = value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = NULL, aes(x = agedf$Age, y = dat0$value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
dim(dat0)
dim(agedf)
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
# geom_line(data = NULL, aes(x = agedf$Age, y = dat0$value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = NULL, aes(x = agedf$Age, y = dat0$value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = agedf, aes(x = agedf$Age, y = dat0$value), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
head(mdf)
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = mdf, aes(x = Age, y = Predicted), col = 'blue') +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = mdf, aes(x = Age, y = Predicted), col = 'blue', lwd = 2) +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = mdf, aes(x = Age, y = Predicted), col = 'blue', lwd = 1.1) +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = mdf, aes(x = Age, y = Predicted), col = 'blue', lwd = 1.1) +
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'Parameters estimated on subset of each strata')
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
geom_line(data = mdf, aes(x = Age, y = Predicted), col = 'blue', lwd = 1.1) +
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'Parameters estimated using subset of each strata')
ggsave(file = paste0(getwd(),"/plots/uniform_fits.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = value), color = 'blue')+
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'Points are actual subsampled data used in parameter fitting')
ggsave(file = paste0(getwd(),"/plots/uniform_fits_sub.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = value), color = 'blue')+
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'Points are actual subsampled data used in parameter fitting')
names(mdf)
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue')+
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'Points are actual subsampled data used in parameter fitting')
ggplot(mdf, aes(x = Age, y = Length)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
geom_point(alpha = 0.2) +
geom_line(aes(y = Predicted), color = 'blue', lwd = 1.1)+
facet_wrap(~ st_f) +
labs(title = "Predicted Model Fits with Uniform Selectivity", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'Points are actual subsampled data used in parameter fitting')
ggsave(file = paste0(getwd(),"/plots/uniform_fits_sub.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
## Plotting ---
## raw len@age, by strata and sex
## change order for order
ggplot(len, aes(x = Age, y = Length_cm, color = Sex)) +
theme_minimal() +
theme(panel.grid = element_blank(), legend.position = c(0.9,0.15))+
scale_y_continuous(limits = c(0,100)) +
scale_x_continuous(limits = c(0,50)) +
scale_color_brewer(palette = 'Dark2') +
geom_point(alpha = 0.2) +
facet_wrap(~ st_f) +
labs(title = "Raw Data", y = 'Length (cm)', x= 'Age (yr)', subtitle = 'NWFSC Groundfish Survey')
ggsave(file = paste0(getwd(),"/plots/raw_data.png"), plot = last_plot(), height = 5, width = 7, unit = 'in', dpi = 520)
