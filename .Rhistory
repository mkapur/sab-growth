shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
## Figure 9 SAB Fits ----
ypreds <- read.csv(paste0("./GAM_output/SAB_predicts_",usedate,"_",phase,".csv"))
ypreds$gamREG <- paste0('GAM-Detected ',ypreds$gamREG)
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ypreds <- read.csv(paste0("./GAM_output/SAB_predicts_",usedate,"_",phase,".csv"))
ypreds$gamREG <- paste0('GAM-Detected ',ypreds$gamREG)
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-Present','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
## Figure 9 SAB Fits ----
ypreds <- read.csv(paste0("./GAM_output/SAB_predicts_",usedate,"_",phase,".csv"))
ypreds <- read.csv(paste0("./GAM_output/SAB_predicts_",usedate,"_",phase,".csv"))
ypreds$gamREG <- paste0('GAM-Detected ',ypreds$gamREG)
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2017','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_manual(values =  cbbPalette)+
geom_point(alpha = 0.5, aes(y = Length_cm)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggsave(plot = last_plot(),
file = paste0("./figures/sab_fits_",Sys.Date(),"_",phase,".png"),
width = 10, height = 12, units = 'in', dpi = 520)
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_manual(values =  cbbPalette[2:4])+
geom_point(alpha = 0.5, aes(y = Length_cm)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_manual(values =  c('grey22','grey44','grey77'))+
geom_point(alpha = 0.5, aes(y = Length_cm)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_manual(values =  c('grey22','grey44','grey77'), aes(shape = REG))+
geom_point(alpha = 0.5, aes(y = Length_cm)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_manual(values =  c('grey22','grey44','grey77') )+
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(rep(1,3),15:17),
linetype = c("solid", "dashed", "dotted",rep(NA,3))))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
# scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(rep(1,3),15:17),
linetype = c("solid", "dashed", "dotted",rep(NA,3))))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
# scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted",rep(NA,3))))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
# scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
# scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
guides(pch = FALSE) +
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
guides(pch = FALSE) +
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
# scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.5, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
guides(pch = FALSE) +
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG),col = 'grey22') +
geom_line(lwd = 1.1, col = 'black')+
guides(pch = FALSE) +
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
# scale_color_manual(values =  )+
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG),col = 'grey22') +
geom_line(lwd = 1.1, col = 'black')+
guides(pch = FALSE) +
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG)) +
geom_line(lwd = 1.1, col = 'black')+
guides(pch = FALSE) +
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
# guides(shape = FALSE) +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
guides(shape = FALSE) +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c(rep('black',3),'grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
guides(shape = FALSE) +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('black','grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
guides(shape = FALSE) +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('black','grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
guides(shape = FALSE) +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('black','grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
ggsave(plot = last_plot(),
file = paste0("./figures/sab_fits_",Sys.Date(),"_",phase,".png"),
width = 10, height = 12, units = 'in', dpi = 520)
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggsave(plot = last_plot(),
file = paste0("./figures/STARstyle_sab_fits_",Sys.Date(),"_",phase,".png"),
width = 10, height = 12, units = 'in', dpi = 520)
ggsave(plot = last_plot(),
file = paste0("./figures/STARstyle_sab_fits_",Sys.Date(),"_",phase,".png"),
width = 10, height = 7, units = 'in', dpi = 520)
